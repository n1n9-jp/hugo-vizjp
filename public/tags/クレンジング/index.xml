<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>クレンジング on Visualizing.JP</title>
        <link>http://localhost:1313/tags/%E3%82%AF%E3%83%AC%E3%83%B3%E3%82%B8%E3%83%B3%E3%82%B0/</link>
        <description>Recent content in クレンジング on Visualizing.JP</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>ja-jp</language>
        <copyright>Yuichi Yazaki</copyright>
        <lastBuildDate>Sun, 19 Nov 2023 00:00:00 +0900</lastBuildDate><atom:link href="http://localhost:1313/tags/%E3%82%AF%E3%83%AC%E3%83%B3%E3%82%B8%E3%83%B3%E3%82%B0/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>Excelでのピボットテーブルの解除</title>
        <link>http://localhost:1313/excel-reverse-pivot/</link>
        <pubDate>Sun, 19 Nov 2023 00:00:00 +0900</pubDate>
        
        <guid>http://localhost:1313/excel-reverse-pivot/</guid>
        <description>&lt;img src="http://localhost:1313/excel-reverse-pivot/images/thumb_ph_vizjp.png" alt="Featured image of post Excelでのピボットテーブルの解除" /&gt;&lt;p&gt;Excelでピボットテーブル化した（もしくはいわゆる横持ちと呼ばれる状態）の表を、ピボットテーブルする前の状態（もしくはいわゆる縦持ちと呼ばれる状態）に戻す作業は、これまでやや複雑でしたが、ExcelにPowerQueryエディタが搭載されてから、手順がかなりシンプルになりました。&lt;/p&gt;
&lt;figure&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/excel-reverse-pivot/images/5740f568-5078-4454-aebd-e84abe75175e.png&#34;
	width=&#34;572&#34;
	height=&#34;227&#34;
	srcset=&#34;http://localhost:1313/excel-reverse-pivot/images/5740f568-5078-4454-aebd-e84abe75175e_hu_fc46231be2dd7d66.png 480w, http://localhost:1313/excel-reverse-pivot/images/5740f568-5078-4454-aebd-e84abe75175e_hu_c56add6fd56e2fa8.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;251&#34;
		data-flex-basis=&#34;604px&#34;
	
&gt;&lt;/p&gt;
&lt;figcaption&gt;
&lt;p&gt;公式ページ掲載の図。左が横持ち、右が縦持ち状態。&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;ここでは、作業手順を、&lt;a class=&#34;link&#34; href=&#34;https://support.microsoft.com/ja-jp/office/%E5%88%97%E3%81%AEpivot%E8%A7%A3%E9%99%A4-power-query-0f7bad4b-9ea1-49c1-9d95-f588221c7098&#34;  title=&#34;https://support.microsoft.com/ja-jp/office/%E5%88%97%E3%81%AEpivot%E8%A7%A3%E9%99%A4-power-query-0f7bad4b-9ea1-49c1-9d95-f588221c7098&#34;
     target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;公式ページ&lt;/a&gt;を噛み砕いて紹介します。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Excelを起動し、空のブックを作成する。&lt;/li&gt;
&lt;li&gt;「データ」タブの「データの取得」から「PowerQueryエディタの起動」を選択する。別ウインドウでPowerQueryエディタが起動します。以後はPowerQueryエディタでの作業です。&lt;/li&gt;
&lt;li&gt;「ファイル」タブ「新しいクエリ」にある「新しいソース」から横持ちCSVファイルを開く。&lt;/li&gt;
&lt;li&gt;変換したい列のみを作業対象として範囲選択します。&lt;/li&gt;
&lt;li&gt;「変換」タブを開き「任意の列」欄から「列のピボット解除」を選択し「選択した列のみをピボット解除」を指定します。これでピボット解除の処理が行われます。&lt;/li&gt;
&lt;li&gt;「ホーム」タブの「閉じて読み込む」を選択します。PowerQueryエディタが閉じ、当初の空のブックに、作業した表データが格納されます。&lt;/li&gt;
&lt;li&gt;ファイルとして保存します。&lt;/li&gt;
&lt;/ol&gt;
</description>
        </item>
        <item>
        <title>OpenRefineでのピボットテーブルの解除</title>
        <link>http://localhost:1313/openrefine-reverse-pivot/</link>
        <pubDate>Sun, 19 Nov 2023 00:00:00 +0900</pubDate>
        
        <guid>http://localhost:1313/openrefine-reverse-pivot/</guid>
        <description>&lt;img src="http://localhost:1313/openrefine-reverse-pivot/images/image_3hours_refine.png" alt="Featured image of post OpenRefineでのピボットテーブルの解除" /&gt;&lt;p&gt;Excelでピボットテーブル化した（もしくはいわゆる横持ちと呼ばれる状態）の表を、ピボットテーブルする前の状態（もしくはいわゆる縦持ちと呼ばれる状態）に戻す作業は、これまでやや複雑でした。オープンソースのクレンジングツールであるOpenRefineを用いると、かなりシンプルな手順で実行することが可能です。&lt;/p&gt;
&lt;p&gt;「業種別の給与階級別構成割合」の表データを参考に手順を紹介します。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/openrefine-reverse-pivot/images/or_reverse-pivot_1.png&#34;
	width=&#34;2268&#34;
	height=&#34;1782&#34;
	srcset=&#34;http://localhost:1313/openrefine-reverse-pivot/images/or_reverse-pivot_1_hu_829f0717f4af65e7.png 480w, http://localhost:1313/openrefine-reverse-pivot/images/or_reverse-pivot_1_hu_d61bd7f5239d82cf.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;127&#34;
		data-flex-basis=&#34;305px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;「行列転置」→「縦持ち化」という機能を呼び出します。どの列からでも大丈夫です。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/openrefine-reverse-pivot/images/or_reverse-pivot_2.png&#34;
	width=&#34;2268&#34;
	height=&#34;1782&#34;
	srcset=&#34;http://localhost:1313/openrefine-reverse-pivot/images/or_reverse-pivot_2_hu_e0dabd280b15c635.png 480w, http://localhost:1313/openrefine-reverse-pivot/images/or_reverse-pivot_2_hu_d5b3844ca6e743a6.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;127&#34;
		data-flex-basis=&#34;305px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;修正する列の範囲を「この列から」「この列まで」指定します。2カラム化を選択します。キーカラム名には属性の名称、値カラム名には値の名称を付けます。横持ちの状態ではいずれの列の名称もデータファイル内に明示されていませんので、適切な名称を付けます。&lt;/p&gt;
&lt;p&gt;「変換対象ではないカラムは直上の値で満たす」にもチェックを入れておきましょう。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/openrefine-reverse-pivot/images/or_reverse-pivot_3.png&#34;
	width=&#34;2268&#34;
	height=&#34;1782&#34;
	srcset=&#34;http://localhost:1313/openrefine-reverse-pivot/images/or_reverse-pivot_3_hu_b8f40732a7478564.png 480w, http://localhost:1313/openrefine-reverse-pivot/images/or_reverse-pivot_3_hu_97d3f05875b171b1.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;127&#34;
		data-flex-basis=&#34;305px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;このように「逆ピボットテーブル化」=「縦持ち化」が行えました。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/openrefine-reverse-pivot/images/or_reverse-pivot_4.png&#34;
	width=&#34;2268&#34;
	height=&#34;1782&#34;
	srcset=&#34;http://localhost:1313/openrefine-reverse-pivot/images/or_reverse-pivot_4_hu_8866bdc2d2f41544.png 480w, http://localhost:1313/openrefine-reverse-pivot/images/or_reverse-pivot_4_hu_c15d7dad00ac06f8.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;127&#34;
		data-flex-basis=&#34;305px&#34;
	
&gt;&lt;/p&gt;
</description>
        </item>
        
    </channel>
</rss>
