+++
author = "Yuichi Yazaki"
title = "ストリームグラフ（Streamgraph）"
slug = "streamgraph"
date = "2020-07-07"
description = ""
categories = [
    "chart"
]
tags = [
    "",
]
image = "images/1_8-t2eXWZyBAQ90tCjZEfvA.png"
+++


ストリームグラフ（Streamgraph）は、時系列データを滑らかな帯状の形で積み重ね、全体の変化と部分の構成比を同時に表現する可視化手法です。折れ線グラフや積み上げ面グラフ（Stacked Area Chart）の一種ですが、ベースラインを中央に配置し、帯の上下に対称的に広がるように描かれる点が特徴です。これにより、全体として有機的で流動的な印象を与え、データの増減やトレンドを美しく表現することができます。

<!--more-->


## 歴史的経緯

Susan Havreらが2000年に出願登録したThemeRiverという名称で論文を発表しています。

- [ThemeRiverTM*: In Search of Trends, Patterns, and Relationships](http://www.ifs.tuwien.ac.at/~silvia/wien/gwa/ws05/articles/Havre-InfoVis1999.pdf)

それとは別に、last.fmのユーザー・リスニング履歴を制作したLee ByronとMartin Wattenbergによって、2008年に書かれた論文が存在します。

- [Stacked Graphs – Geometry & Aesthetics](http://leebyron.com/streamgraph/stackedgraphs_byron_wattenberg.pdf)

現在はストリームグラフ（Streamgraph）と呼ばれることが一般的です。




## データ構造

ストリームグラフでは、カテゴリ（例：映画のジャンルやアーティスト）ごとの時系列データが必要です。各カテゴリの時間ごとの値（例えば興行収入、再生回数など）を積み上げていきます。通常の積み上げ面グラフと異なり、中央を基準にして上下に帯を配置するため、視覚的なバランスを取るための「ストリームレイアウト」アルゴリズム（例えば *wiggle layout*）が利用されます。


## 目的

主な目的は、複数の時系列カテゴリを一目で比較しながら、全体の流れや変動パターンを把握することです。特に、定量的な比較よりも全体的なトレンドや構成の変遷を強調したい場合に適しています。


## ユースケース

- 音楽や映画の人気推移（例：Spotifyのジャンル別再生シェア）
- トピックの流行の変化（例：SNSでの言及数の時間変化）
- 科学分野の研究テーマの推移
- 企業やブランド別の市場シェアの時系列変化


## 特徴

| 特徴 | 内容 |
|------|------|
| 形状 | 滑らかで有機的な帯状の積層構造 |
| ベースライン | 中央基準（対称配置） |
| データ数 | 多カテゴリ・多時点に適する |
| 読み取り | 相対的なトレンドの把握に強い |
| 弱点 | 定量的比較には不向き |

時間の経過とともに変化する数値を、総体と個別を同時に、流れとして把握できることを意図したチャート。流れとして全体感を把握するところから、名称にstreamやriverといった単語が用いられている。初出は2000年ごろで比較的最近登場したチャート。

ベースラインとしての水平軸が存在しないため、データの総体と個別が生み出す造形は、予想できない美しさと傾向や発見の手がかりを生み出す。


## チャートの見方

中央を基準に広がる各帯がカテゴリを表し、縦幅はその時点での値の大きさを意味します。全体の厚みは総量を示し、帯の形状の変化によって、カテゴリごとの盛衰を視覚的に読み取ることができます。


## デザイン上の注意点

- 色の選定はカテゴリごとの識別性を保ちながら、過度なコントラストを避ける。
- スムージング処理を行いすぎると、実際の変化が過度に滑らかになり誤解を招く恐れがある。
- 中央基準での配置により、値の絶対量を正確に比較するのは難しいため、補足として凡例や注釈を併用する。
- 大量のカテゴリを含む場合、視認性が下がるため、主要なカテゴリに絞るか、インタラクティブ表示を検討する。

正確な数値の読み取りやすさが足りないと指摘する声もあり、視覚的な美しさと正確な数値の読み取りやすさのバランスについて、議論になることが多い。レイヤーをどの順序で積み重ねるかはアルゴリズム次第で、データのどの属性を用いるかによって印象は相当変わる。この点も、正確な数値の読み取りやすさのバランスについて懸念される原因の一つとなっている。


## 応用例

- D3.jsやPlotlyでは`stackOffset: "wiggle"`の設定でストリームグラフを生成可能。
- FlourishやRAWGraphsなどのノーコードツールでもテンプレートとして利用可能。
- アート的なデータ表現やビジュアルストーリーテリングの演出としても人気。


## 代替例

| 代替チャート | 用途上の違い |
|---------------|----------------|
| 積み上げ面グラフ | 正確な値比較を重視 |
| リッジラインプロット | 分布や密度の比較に特化 |
| サンキーダイアグラム | フローの関係性を強調 |
| ヒートマップ | 値の大小を網羅的に比較 |


## まとめ

ストリームグラフは、単なる時系列の積み上げ表示にとどまらず、時間とカテゴリが織りなす「流れ」を芸術的に描き出すチャートです。感覚的な理解や物語的な可視化を目指す際に特に有効であり、データとデザインの融合を象徴する代表的な手法といえます。


## 参考・出典

- [Lee Byron – Streamgraph Original Project](https://leebyron.com/streamgraph/)
- [New York Times: The Ebb and Flow of Movies](https://www.nytimes.com/interactive/2008/02/23/movies/20080223_REVENUE_GRAPHIC.html)
